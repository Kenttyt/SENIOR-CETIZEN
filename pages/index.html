<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!----======== CSS ======== -->
      <link rel="stylesheet" href="../css/style.css">
      <link rel="stylesheet" href="../css/chatbot.css">
      <!----===== Iconscout CSS ===== -->
      <link rel   ="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
      <title>Senior Citizen </title>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
   </head>
   <body>
      <nav>
         <div class="logo-name">
            <div class="logo-image">
               <img src="../img/logo.jpg" alt="">
            </div>
            <span class="logo_name">SmartSenior
            </span>
         </div>
         <div class="menu-items">
            <ul class="nav-links">
               <li><a href="#">
                  <i class="uil uil-estate"></i>
                  <span class="link-name">Meetings</span>
                  </a>
               </li>
               <li><a href="members.html">
                  <i class="uil uil-users-alt"></i>
                  <span class="link-name">Members</span>
                  </a>
               </li>
               <li><a href="financialmanagement.html">
                  <i class="uil uil-chart"></i>
                  <span class="link-name">Financial Management </span>
                  </a>
               </li>
               <li><a href="feedbacks.html">
                  <i class="uil uil-thumbs-up"></i>
                  <span class="link-name">Feedbacks</span>
                  </a>
               </li>
               <li><a href="messages.html">
                  <i class="uil uil-comments"></i>
                  <span class="link-name">Messages</span>
                  </a>
               </li>
            </ul>
            <ul class="logout-mode">
               <li><a href="#">
                  <i class="uil uil-signout"></i>
                  <span class="link-name">Logout</span>
                  </a>
               </li>
               </li>
            </ul>
         </div>
      </nav>
      <section class="dashboard">
         <div class="top">
            <i class="uil uil-bars sidebar-toggle"></i>
            <div id="current-date" class="current-date"></div>
         </div>
         
         
         
         
         
         
         <style>
            .overview .boxes {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-between;
            }

            .box {
            flex: 1 1 250px;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
            background: #f5f5f5;
            transition: transform 0.3s;
            }

            .box:hover {
            transform: translateY(-5px);
            }

            .export-buttons {
            display: flex;
            gap: 10px;
            }

            .export-btn {
            background-color: #034c73;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 0.9em;
            }

            .export-btn:hover {
            background-color: #026aa7;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            }

            .export-btn i {
            font-size: 1.2em;
            transition: transform 0.3s ease;
            }

            .export-btn:hover i {
            transform: scale(1.1);
            }

            @media (max-width: 600px) {
            .export-btn {
            width: auto;
            padding: 10px 20px;
            }

            .export-btn i {
            font-size: 1.3em;
            }
            }

            .no-data-message {
            text-align: center;
            padding: 30px;
            color: #666;
            font-size: 1.1em;
            background-color: #f9f9f9;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            }

            .no-data-message i {
            font-size: 2.5em;
            color: #034c73;
            margin-bottom: 15px;
            display: block;
            }

            @media (max-width: 768px) {
            .no-data-message {
                padding: 20px;
                font-size: 1em;
                margin: 15px 0;
            }
            
            .no-data-message i {
                font-size: 2em;
                margin-bottom: 10px;
            }
            }
            @media (max-width: 480px) {
            .no-data-message {
                padding: 15px;
                margin: 10px 0;
            }
            
            .no-data-message i {
                font-size: 1.8em;
                margin-bottom: 8px;
            }
            }
         </style>
         
            <div class="meeting-box">
               <button onclick="window.location.href='newmeeting.html'">New Meeting</button>
            </div>
         </div>
         <style>

            .meeting-box {
            margin-top: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            }

            .meeting-box button {
            width: 90%;
            max-width: 500px;
            background-color: #034c73;
            color: white;
            padding: 20px;
            margin: 10px 0;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s;
            }

            .meeting-box button:hover {
            background-color: #026aa7;
            }

            /* Medium screens */
            @media (max-width: 600px) {
            .meeting-box button {
            font-size: 1em;
            padding: 15px;
            }
            }
            
            .selector-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 100%;
            margin: auto;
            }

            .year-wrapper,
            .month-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            }

            .arrow {
            font-size: 20px;
            background: #034c73;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            }

            .arrow:hover {
            background: #026aa7;
            transform: scale(1.1);
            }

            .arrow:active {
            transform: scale(0.95);
            }

            .year-scroll,
            .month-scroll {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
            flex-grow: 1;
            padding: 10px 0;
            position: relative;
            scroll-snap-type: x mandatory;
            }

            .year-scroll::-webkit-scrollbar,
            .month-scroll::-webkit-scrollbar {
            display: none;
            }

            .year, .month {
            min-width: 60px;
            padding: 8px 10px;
            text-align: center;
            background: #f5f5f5;
            border-radius: 8px;
            cursor: pointer;
            white-space: nowrap;
            flex-shrink: 0;
            transition: transform 0.3s ease, background-color 0.3s ease;
            scroll-snap-align: center;
            
            }
            .year.active {
            background: #007bff;
            color: white;
            font-weight: bold;
            transform: scale(1.5);
            }

            .month.active {
            background:  #007bff;
            color: white;
            font-weight: bold;
            transform: scale(1.5);
            }

            label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            }

            .activity-data-table  {
            max-height:40px;
            overflow-y: auto;
            display: block;
            background-color: #f5f5dc;
            }
            
            .data-row {
            display: flex;
            border-bottom: 1px solid #ddd;
            height:40px;
            }

            .cell {
            flex: 1;
            padding: 8px;
            display: flex;
            align-items: center;
            padding:10px;
            }

            .header-row {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 2;
            border-bottom: 2px solid #aaa;
            }

            .activity-data-table {
            max-height: 900px;
            overflow-y: auto;
            border: 1px solid #ccc;
            margin-top:12px;
            }

            .data-table-scroll {
            width: 100%;
            }

            .data-row.header {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 2;
            border-bottom: 2px solid #ccc;
            font-weight: bold;
            }

            .data-row {
            display: flex;
            border-bottom: 1px solid #eee;
            }

            .cell {
            flex: 1;
            padding: 10px;
            }

            .search-box {
            margin-top:10px;
            position: relative;
            height: 45px;
            width: 100%;
            max-width: 100%;
            }

            .search-box input {
            width: 100%;
            height: 100%;
            padding: 0 25px 0 50px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--panel-color);
            color: var(--text-color);
            font-size: 15px;
            outline: none;
            color : black;
            }

            .search-box i {
            position: absolute;
            top: 50%;
            left: 15px;
            transform: translateY(-50%);
            font-size: 22px;
            color: var(--black-light-color);
            }

            .summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
            padding: 20px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-top: 10px;
            flex-wrap: wrap;
            gap: 10px;
            }

            .summary div {
            font-weight: bold;
            }
            
         </style>
         <h1 style="text-align: center; font-size: 32px; font-weight: bold; margin-bottom: 30px;">
            Histories Of Meeting
         </h1>
         <div class="selector-container">
         <div class="selector-container">
            <label>Select Year</label>
            <div class="year-wrapper">
               <button class="arrow" onclick="scrollYears(-1)">â€¹</button>
               <div class="year-scroll" id="yearScroll"></div>
               <button class="arrow" onclick="scrollYears(1)">â€º</button>
            </div>
            <label>Select Month</label>
            <div class="month-wrapper">
               <button class="arrow" onclick="scrollMonths(-1)">â€¹</button>
               <div class="month-scroll" id="monthScroll"></div>
               <button class="arrow" onclick="scrollMonths(1)">â€º</button>
            </div>
         </div>
         <script>
            const yearScroll = document.getElementById("yearScroll");
            const startYear = 2025;
            const endYear = 2035;
            const yearList = [];
            
            function createYearItems() {
            yearScroll.innerHTML = ""; // clear content
            
            const spacerWidth = yearScroll.offsetWidth / 2;
            
            // Add spacer at start with original design
            const spacerStart = document.createElement("div");
            spacerStart.style.minWidth = `${spacerWidth}px`;
            spacerStart.style.height = "1px";
            yearScroll.appendChild(spacerStart);
            
            // Add invisible items at start
            for (let i = 0; i < 3; i++) {
                const spacerDiv = document.createElement("div");
                spacerDiv.classList.add("year");
                spacerDiv.style.opacity = "0";
                spacerDiv.style.pointerEvents = "none";
                spacerDiv.textContent = startYear;
                yearScroll.appendChild(spacerDiv);
            }
            
            for (let y = startYear; y <= endYear; y++) {
                const yearDiv = document.createElement("div");
                yearDiv.classList.add("year");
                yearDiv.textContent = y;
                yearDiv.dataset.value = y;
                yearDiv.onclick = () => centerYear(yearDiv);
                yearScroll.appendChild(yearDiv);
                yearList.push(yearDiv);
            }
            
            // Add invisible items at end
            for (let i = 0; i < 3; i++) {
                const spacerDiv = document.createElement("div");
                spacerDiv.classList.add("year");
                spacerDiv.style.opacity = "0";
                spacerDiv.style.pointerEvents = "none";
                spacerDiv.textContent = endYear;
                yearScroll.appendChild(spacerDiv);
            }
            
            // Add spacer at end with original design
            const spacerEnd = document.createElement("div");
            spacerEnd.style.minWidth = `${spacerWidth}px`;
            spacerEnd.style.height = "1px";
            yearScroll.appendChild(spacerEnd);
            }
            
            function setActiveYear(selectedDiv) {
            document.querySelectorAll(".year").forEach(el => el.classList.remove("active"));
            selectedDiv.classList.add("active");
            }
            
            function centerYear(el) {
            // Check if this is an invisible spacer
            if (el.style.opacity === "0") {
                // If it's before the first year, bounce to first year
                if (parseInt(el.textContent) === startYear) {
                    const firstYear = yearList[0];
                    const scrollLeft = firstYear.offsetLeft - (yearScroll.offsetWidth / 2 - firstYear.offsetWidth / 2);
                    yearScroll.scrollTo({ left: scrollLeft, behavior: 'smooth' });
                    setActiveYear(firstYear);
                    return;
                }
                // If it's after the last year, bounce to last year
                if (parseInt(el.textContent) === endYear) {
                    const lastYear = yearList[yearList.length - 1];
                    const scrollLeft = lastYear.offsetLeft - (yearScroll.offsetWidth / 2 - lastYear.offsetWidth / 2);
                    yearScroll.scrollTo({ left: scrollLeft, behavior: 'smooth' });
                    setActiveYear(lastYear);
                    return;
                }
            }
            
            const scrollLeft = el.offsetLeft - (yearScroll.offsetWidth / 2 - el.offsetWidth / 2);
            yearScroll.scrollTo({ left: scrollLeft, behavior: 'smooth' });
            setActiveYear(el);
            }
            
            function scrollYears(direction) {
            const yearScroll = document.getElementById('yearScroll');
            const visibleYears = yearScroll.querySelectorAll('.year:not([style*="opacity: 0"])');
            const itemWidth = visibleYears[0].offsetWidth + 10;
            const scrollAmount = direction * itemWidth;
            
            yearScroll.scrollBy({
                left: scrollAmount,
                behavior: 'smooth'
            });
            }
            
            function selectCenterYear() {
            const center = yearScroll.scrollLeft + yearScroll.offsetWidth / 2;
            let closest = null;
            let minDistance = Infinity;
            
            document.querySelectorAll('.year').forEach(el => {
            const elCenter = el.offsetLeft + el.offsetWidth / 2;
            const distance = Math.abs(center - elCenter);
            if (distance < minDistance) {
             minDistance = distance;
             closest = el;
            }
            });
            
            if (closest) {
            centerYear(closest);
            }
            }
            
            let scrollTimeout;
            yearScroll.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(selectCenterYear, 100);
            });
            
            window.addEventListener("load", () => {
            createYearItems();
            const midIndex = Math.floor((endYear - startYear + 1) / 12);
            const initial = document.querySelectorAll('.year')[midIndex];
            centerYear(initial);
            });
            
            // Resize fix
            let lastWindowWidth = window.innerWidth;
            
            window.addEventListener("resize", () => {
            if (window.innerWidth !== lastWindowWidth) {
            lastWindowWidth = window.innerWidth;
            
            const active = document.querySelector('.year.active');
            const activeYear = active ? active.dataset.value : null;
            
            yearList.length = 0;
            createYearItems();
            
            if (activeYear) {
             const match = [...document.querySelectorAll('.year')].find(
               y => y.dataset.value === activeYear
             );
             if (match) centerYear(match);
            }
            }
            });
            
            
            // MONTHS
            const monthScroll = document.getElementById("monthScroll");
            const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                           "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            const monthList = [];
            
            function createMonthItems() {
            monthScroll.innerHTML = "";
            
            const spacerWidth = monthScroll.offsetWidth / 2;
            
            // Add spacer at start with original design
            const spacerStart = document.createElement("div");
            spacerStart.style.minWidth = `${spacerWidth}px`;
            spacerStart.style.height = "1px";
            monthScroll.appendChild(spacerStart);
            
            // Add invisible items at start
            for (let i = 0; i < 3; i++) {
                const spacerDiv = document.createElement("div");
                spacerDiv.classList.add("month");
                spacerDiv.style.opacity = "0";
                spacerDiv.style.pointerEvents = "none";
                spacerDiv.textContent = monthNames[0];
                monthScroll.appendChild(spacerDiv);
            }
            
            monthNames.forEach((name, i) => {
                const monthDiv = document.createElement("div");
                monthDiv.classList.add("month");
                monthDiv.textContent = name;
                monthDiv.dataset.value = String(i + 1).padStart(2, "0");
                monthDiv.onclick = () => centerMonth(monthDiv);
                monthScroll.appendChild(monthDiv);
                monthList.push(monthDiv);
            });
            
            // Add invisible items at end
            for (let i = 0; i < 3; i++) {
                const spacerDiv = document.createElement("div");
                spacerDiv.classList.add("month");
                spacerDiv.style.opacity = "0";
                spacerDiv.style.pointerEvents = "none";
                spacerDiv.textContent = monthNames[monthNames.length - 1];
                monthScroll.appendChild(spacerDiv);
            }
            
            // Add spacer at end with original design
            const spacerEnd = document.createElement("div");
            spacerEnd.style.minWidth = `${spacerWidth}px`;
            spacerEnd.style.height = "1px";
            monthScroll.appendChild(spacerEnd);
            }
            
            function setActiveMonth(selectedDiv) {
            document.querySelectorAll(".month").forEach(el => el.classList.remove("active"));
            selectedDiv.classList.add("active");
            }
            
            function centerMonth(el) {
            // Check if this is an invisible spacer
            if (el.style.opacity === "0") {
                // If it's before January, bounce to January
                if (el.textContent === monthNames[0]) {
                    const firstMonth = monthList[0];
                    const scrollLeft = firstMonth.offsetLeft - (monthScroll.offsetWidth / 2 - firstMonth.offsetWidth / 2);
                    monthScroll.scrollTo({ left: scrollLeft, behavior: 'smooth' });
                    setActiveMonth(firstMonth);
                    return;
                }
                // If it's after December, bounce to December
                if (el.textContent === monthNames[monthNames.length - 1]) {
                    const lastMonth = monthList[monthList.length - 1];
                    const scrollLeft = lastMonth.offsetLeft - (monthScroll.offsetWidth / 2 - lastMonth.offsetWidth / 2);
                    monthScroll.scrollTo({ left: scrollLeft, behavior: 'smooth' });
                    setActiveMonth(lastMonth);
                    return;
                }
            }
            
            const scrollLeft = el.offsetLeft - (monthScroll.offsetWidth / 2 - el.offsetWidth / 2);
            monthScroll.scrollTo({ left: scrollLeft, behavior: 'smooth' });
            setActiveMonth(el);
            }
            
            function scrollMonths(direction) {
            const monthScroll = document.getElementById('monthScroll');
            const visibleMonths = monthScroll.querySelectorAll('.month:not([style*="opacity: 0"])');
            const itemWidth = visibleMonths[0].offsetWidth + 10;
            const scrollAmount = direction * itemWidth;
            
            monthScroll.scrollBy({
                left: scrollAmount,
                behavior: 'smooth'
            });
            }
            
            function selectCenterMonth() {
            const center = monthScroll.scrollLeft + monthScroll.offsetWidth / 2;
            let closest = null;
            let minDistance = Infinity;
            
            document.querySelectorAll('.month').forEach(el => {
            const elCenter = el.offsetLeft + el.offsetWidth / 2;
            const distance = Math.abs(center - elCenter);
            if (distance < minDistance) {
             minDistance = distance;
             closest = el;
            }
            });
            
            if (closest) {
            centerMonth(closest);
            }
            }
            
            let monthScrollTimeout;
            monthScroll.addEventListener('scroll', () => {
            clearTimeout(monthScrollTimeout);
            monthScrollTimeout = setTimeout(selectCenterMonth, 100);
            });
            
            window.addEventListener("load", () => {
            createMonthItems();
            const currentMonth = new Date().getMonth(); // 0-indexed
            const initial = document.querySelectorAll('.month')[currentMonth];
            centerMonth(initial);
            });
            
            
            
            
         </script>         
         <script>
            function filterTable() {
             const input = document.getElementById('search-input').value.toLowerCase();
             const rows = document.querySelectorAll('.activity-data-table .data-row'); // Select all rows
            
             rows.forEach(row => {
               if (row.classList.contains('header-row')) {
                 // Ensure the header row is always visible
                 row.style.display = '';
                 return;
               }
            
               const nameCell = row.querySelector('.cell:first-child'); // first cell is name
               const contributionCell = row.querySelector('.cell:nth-child(2)'); // second cell is contribution
               const name = nameCell.textContent.toLowerCase();
               const contribution = contributionCell.textContent.toLowerCase();
            
               if (name.includes(input) || contribution.includes(input)) {
                 row.style.display = '';
               } else {
                 row.style.display = 'none';
               }
             });
            }
                 
             
         </script>
         <script>
            function updateSummaryHeader() {
              const activeYear = document.querySelector('.year.active')?.textContent;
              const activeMonthIndex = document.querySelector('.month.active')?.dataset.value;
              const monthNamesFull = ["January", "February", "March", "April", "May", "June",
                                      "July", "August", "September", "October", "November", "December"];
              if (activeYear && activeMonthIndex) {
                const monthName = monthNamesFull[parseInt(activeMonthIndex) - 1];
                document.querySelector('.summary div').innerHTML = 
                  `Total Contributions (${monthName} ${activeYear}): <span id="total-contribution">â‚±0</span>`;
              }
            }
            
            // Hook into existing centerYear and centerMonth functions
            const originalCenterYear = centerYear;
            centerYear = function(el) {
              originalCenterYear(el);
              updateSummaryHeader();
            }
            
            const originalCenterMonth = centerMonth;
            centerMonth = function(el) {
              originalCenterMonth(el);
              updateSummaryHeader();
            }
         </script>
         <script>
            const dummyData = {};
            
            const months = Array.from({ length: 12 }, (_, i) => String(i + 1).padStart(2, '0'));
            
            dummyData["2025"] = {};
            
            months.forEach(month => {
              dummyData["2025"][month] = Array.from({ length: 250 }, (_, i) => ({
                name: `Member ${i + 1}`,
                contribution: Math.random() > 0.5 ? 10 : 0,
                attendance: Math.random() > 0.2 ? "Present" : "Absent"
              }));
            });
         </script>
         <script>
            function updateTable() {
              const year = document.querySelector('.year.active')?.textContent;
              const month = document.querySelector('.month.active')?.dataset.value;
              
              const table = document.getElementById('dataTable');
              const noDataMessage = document.getElementById('noDataMessage');
              const rows = table.querySelectorAll('.data-row:not(.header-row)');
              rows.forEach(row => row.remove()); // Clear previous rows
              
              let total = 0;
              let presentCount = 0;
              
              if (year && month && dummyData[year] && dummyData[year][month] && dummyData[year][month].length > 0) {
                  // Hide no data message and show table
                  noDataMessage.style.display = 'none';
                  table.style.display = 'block';
                  
                  dummyData[year][month].forEach(entry => {
                      const row = document.createElement('div');
                      row.className = 'data-row';
                      row.innerHTML = `
                        <div class="cell">${entry.name}</div>
                        <div class="cell">â‚±${entry.contribution}</div>
                        <div class="cell">Present</div>
                      `;
                      table.appendChild(row);
                      total += entry.contribution;
                      presentCount++;
                  });
              } else {
                  // Show no data message and hide table content except header
                  noDataMessage.style.display = 'block';
                  table.style.display = 'none';
              }
              
              const totalMembers = dummyData[year]?.[month]?.length || 0;
              // Calculate a fixed percentage (e.g., 80%) instead of actual percentage
              const percentage = 80.0;
              
              document.getElementById('total-contribution').textContent = `â‚±${total}`;
              document.getElementById('total-participants').textContent = Math.floor(totalMembers * 0.8);
              document.getElementById('participant-percentage').textContent = `${percentage}%`;
            }
            
            // Update when year or month changes
            const originalCenterYear_ = centerYear;
            centerYear = function(el) {
              originalCenterYear_(el);
              updateSummaryHeader();
              updateTable();
            }
            
            const originalCenterMonth_ = centerMonth;
            centerMonth = function(el) {
              originalCenterMonth_(el);
              updateSummaryHeader();
              updateTable();
            }
            
            window.addEventListener("load", updateTable);
         </script>
         <div class="summary">
            <div>Total Contributions : <span id="total-contribution">â‚±0</span></div>
            <div>Total Participants: <span id="total-participants">0</span> (<span id="participant-percentage">0%</span>)</div>
            <button class="export-btn" onclick="exportToPDF()">
                <i class="uil uil-file-export"></i>
                <i class="uil uil-file-pdf"></i>
                Export to PDF
            </button>
         </div>
         <div class="search-box">
            <i class="uil uil-search"></i>
            <input type="text" id="search-input" placeholder="Search here..." oninput="filterTable()">
         </div>
         <div class="activity-data-table" id="dataTable">
            <div class="data-row header-row">
                <div class="cell">Name</div>
                <div class="cell">Contribution</div>
                <div class="cell">Attendance</div>
            </div>
         </div>
         <div id="noDataMessage" class="no-data-message" style="display: none;">
            <i class="uil uil-calendar-alt"></i>
            No meeting data available for this period
         </div>
         <!-- Chat Bot -->
         <!-- Chat Widget -->
         <div class="chat-widget" id="chat-widget">
            <div class="chat-bubble" id="chat-bubble">
               <i>ðŸ’¬</i>
            </div>
            <div class="chat-container" id="chat-container">
               <div class="chat-header">
                  <div class="chat-title">
                     <span class="status-indicator"></span>
                     AI Assistant
                  </div>
                  <div class="chat-close" id="chat-close">Ã—</div>
               </div>
               <div class="chat-messages" id="chat-messages">
                  <div class="message-container bot-container">
                     <div class="message bot-message">
                        Maayong adlaw! Ako imong AI assistant. Unsay akong ikatabang nimo karon?
                     </div>
                     <span class="timestamp">Now</span>
                  </div>
                  <div class="typing-indicator" id="typing-indicator">
                     <div class="typing-bubble"></div>
                     <div class="typing-bubble"></div>
                     <div class="typing-bubble"></div>
                  </div>
               </div>
               <div class="chat-input">
                  <textarea class="chat-input-field" id="chat-input-field" placeholder="I-type imong mensahe..." rows="1"></textarea>
                  <button class="chat-send-btn" id="chat-send-btn">âž¤</button>
               </div>
            </div>
         </div>
      </section>
      <script src="../js/script.js"></script>
      <script src="../js/chatbot.js"></script>
      <script>
         function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const year = document.querySelector('.year.active')?.textContent;
            const month = document.querySelector('.month.active')?.dataset.value;
            const monthName = monthNames[parseInt(month) - 1];
            
            // Create PDF document with larger page size
            const doc = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });
            
            // Add header with background
            doc.setFillColor(3, 76, 115); // #034c73
            doc.rect(0, 0, doc.internal.pageSize.width, 40, 'F');
            
            // Add title with white text
            doc.setTextColor(255, 255, 255);
            doc.setFont(undefined, 'bold');
            doc.setFontSize(24);
            doc.text('Meeting Attendance Report', doc.internal.pageSize.width / 2, 20, { align: 'center' });
            doc.setFontSize(16);
            doc.text(`${monthName} ${year}`, doc.internal.pageSize.width / 2, 30, { align: 'center' });
            
            // Add summary box
            doc.setDrawColor(3, 76, 115);
            doc.setLineWidth(0.5);
            doc.roundedRect(15, 50, doc.internal.pageSize.width - 30, 40, 3, 3);
            
            // Add summary information
            doc.setTextColor(3, 76, 115);
            doc.setFontSize(14);
            const totalContribution = document.getElementById('total-contribution').textContent.replace('â‚±', '');
            const totalParticipants = document.getElementById('total-participants').textContent;
            const participantPercentage = document.getElementById('participant-percentage').textContent;
            
            doc.text('Summary', 25, 65);
            doc.setFont(undefined, 'normal');
            doc.setFontSize(12);
            doc.text(`Total Contributions: ${totalContribution}`, 25, 75);
            doc.text(`Total Participants: ${totalParticipants} (${participantPercentage})`, 25, 82);
            
            // Prepare table data
            const tableData = [];
            const tableRows = document.querySelectorAll('#dataTable .data-row:not(.header-row)');
            
            tableRows.forEach(row => {
                const cells = row.querySelectorAll('.cell');
                tableData.push([
                    cells[0].textContent,                              // Name
                    cells[1].textContent.replace('â‚±', ''),            // Contribution without â‚± symbol
                    cells[2].textContent                              // Attendance
                ]);
            });
            
            // Add table with improved styling
            doc.autoTable({
                head: [['Name', 'Contribution', 'Attendance']],
                body: tableData,
                startY: 100,
                styles: {
                    fontSize: 10,
                    cellPadding: 5,
                    lineColor: [3, 76, 115],
                    lineWidth: 0.1
                },
                headStyles: {
                    fillColor: [3, 76, 115],
                    textColor: [255, 255, 255],
                    fontSize: 12,
                    fontStyle: 'bold',
                    halign: 'center'
                },
                bodyStyles: {
                    textColor: [68, 68, 68]
                },
                alternateRowStyles: {
                    fillColor: [240, 245, 250]
                },
                columnStyles: {
                    0: { cellWidth: 'auto' },
                    1: { cellWidth: 'auto', halign: 'center' },
                    2: { cellWidth: 'auto', halign: 'center' }
                },
                margin: { top: 100, left: 15, right: 15 }
            });
            
            // Add footer with page numbers and timestamp
            const pageCount = doc.internal.getNumberOfPages();
            const now = new Date().toLocaleString();
            
            for(let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(128, 128, 128);
                
                // Add timestamp on the left
                doc.text(`Generated: ${now}`, 15, doc.internal.pageSize.height - 10);
                
                // Add page numbers on the right
                doc.text(
                    `Page ${i} of ${pageCount}`,
                    doc.internal.pageSize.width - 15,
                    doc.internal.pageSize.height - 10,
                    { align: 'right' }
                );
            }
            
            // Save the PDF
            doc.save(`Meeting_Attendance_${monthName}_${year}.pdf`);
         }
      </script>
   </body>
</html>
